---
source: src/datafusion-client/src/tests/mod.rs
expression: displayable.tree_render().to_string()
---
┌───────────────────────────┐
│  SortPreservingMergeExec  │
│    --------------------   │
│     o_totalprice DESC,    │
│       o_orderdate ASC     │
│         NULLS LAST        │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│          SortExec         │
│    --------------------   │
│    o_totalprice@4 DESC,   │
│      o_orderdate@3 ASC    │
│         NULLS LAST        │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       AggregateExec       │
│    --------------------   │
│           aggr:           │
│  sum(lineitem.l_quantity) │
│                           │
│         group_by:         │
│     c_name, c_custkey,    │
│         o_orderkey,       │
│        o_orderdate,       │
│        o_totalprice       │
│                           │
│           mode:           │
│      FinalPartitioned     │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      RepartitionExec      │
│    --------------------   │
│ partition_count(in->out): │
│           8 -> 8          │
│                           │
│    partitioning_scheme:   │
│ Hash([c_name@0, c_custkey │
│     @1, o_orderkey@2,     │
│       o_orderdate@3,      │
│     o_totalprice@4], 8)   │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       AggregateExec       │
│    --------------------   │
│           aggr:           │
│  sum(lineitem.l_quantity) │
│                           │
│         group_by:         │
│     c_name, c_custkey,    │
│         o_orderkey,       │
│        o_orderdate,       │
│        o_totalprice       │
│                           │
│       mode: Partial       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│        HashJoinExec       │
│    --------------------   │
│    join_type: RightSemi   │
│                           ├──────────────┐
│            on:            │              │
│ (l_orderkey = o_orderkey) │              │
└─────────────┬─────────────┘              │
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│   CoalescePartitionsExec  ││      RepartitionExec      │
│                           ││    --------------------   │
│                           ││ partition_count(in->out): │
│                           ││           1 -> 8          │
│                           ││                           │
│                           ││    partitioning_scheme:   │
│                           ││     RoundRobinBatch(8)    │
└─────────────┬─────────────┘└─────────────┬─────────────┘
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         FilterExec        ││        HashJoinExec       │
│    --------------------   ││    --------------------   │
│         predicate:        ││            on:            ├───────────────────────────────────────────┐
│ sum(lineitem.l_quantity) >││ (o_orderkey = l_orderkey) │                                           │
│      Some(30000),25,2     ││                           │                                           │
└─────────────┬─────────────┘└─────────────┬─────────────┘                                           │
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│       AggregateExec       ││        HashJoinExec       │                             │   LiquidCacheClientExec   │
│    --------------------   ││    --------------------   │                             │    --------------------   │
│           aggr:           ││            on:            │                             │          server:          │
│  sum(lineitem.l_quantity) ││  (c_custkey = o_custkey)  │                             │  http://localhost:50051,  │
│                           ││                           ├──────────────┐              │      object_stores=[]     │
│    group_by: l_orderkey   ││                           │              │              │                           │
│                           ││                           │              │              │                           │
│           mode:           ││                           │              │              │                           │
│      FinalPartitioned     ││                           │              │              │                           │
└─────────────┬─────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│      RepartitionExec      ││   LiquidCacheClientExec   ││   LiquidCacheClientExec   ││       DataSourceExec      │
│    --------------------   ││    --------------------   ││    --------------------   ││    --------------------   │
│ partition_count(in->out): ││          server:          ││          server:          ││          files: 1         │
│           1 -> 8          ││  http://localhost:50051,  ││  http://localhost:50051,  ││      format: parquet      │
│                           ││      object_stores=[]     ││      object_stores=[]     ││                           │
│    partitioning_scheme:   ││                           ││                           ││         predicate:        │
│  Hash([l_orderkey@0], 8)  ││                           ││                           ││  DynamicFilter [ empty ]  │
└─────────────┬─────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘└───────────────────────────┘
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       AggregateExec       ││       DataSourceExec      ││       DataSourceExec      │
│    --------------------   ││    --------------------   ││    --------------------   │
│           aggr:           ││          files: 1         ││          files: 1         │
│  sum(lineitem.l_quantity) ││      format: parquet      ││      format: parquet      │
│                           ││                           ││                           │
│    group_by: l_orderkey   ││                           ││         predicate:        │
│       mode: Partial       ││                           ││  DynamicFilter [ empty ]  │
└─────────────┬─────────────┘└───────────────────────────┘└───────────────────────────┘
┌─────────────┴─────────────┐
│   LiquidCacheClientExec   │
│    --------------------   │
│          server:          │
│  http://localhost:50051,  │
│      object_stores=[]     │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       DataSourceExec      │
│    --------------------   │
│          files: 1         │
│      format: parquet      │
└───────────────────────────┘
