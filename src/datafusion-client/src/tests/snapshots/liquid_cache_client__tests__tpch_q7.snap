---
source: src/datafusion-client/src/tests/mod.rs
expression: displayable.tree_render().to_string()
---
┌───────────────────────────┐
│  SortPreservingMergeExec  │
│    --------------------   │
│ supp_nation ASC NULLS LAST│
│  , cust_nation ASC NULLS  │
│   LAST, l_year ASC NULLS  │
│            LAST           │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│          SortExec         │
│    --------------------   │
│  supp_nation@0 ASC NULLS  │
│     LAST, cust_nation@1   │
│   ASC NULLS LAST, l_year  │
│     @2 ASC NULLS LAST     │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       ProjectionExec      │
│    --------------------   │
│        cust_nation:       │
│        cust_nation        │
│                           │
│       l_year: l_year      │
│                           │
│          revenue:         │
│    sum(shipping.volume)   │
│                           │
│        supp_nation:       │
│        supp_nation        │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       AggregateExec       │
│    --------------------   │
│           aggr:           │
│    sum(shipping.volume)   │
│                           │
│         group_by:         │
│ supp_nation, cust_nation, │
│           l_year          │
│                           │
│           mode:           │
│      FinalPartitioned     │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      RepartitionExec      │
│    --------------------   │
│ partition_count(in->out): │
│           8 -> 8          │
│                           │
│    partitioning_scheme:   │
│    Hash([supp_nation@0,   │
│       cust_nation@1,      │
│        l_year@2], 8)      │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       AggregateExec       │
│    --------------------   │
│           aggr:           │
│    sum(shipping.volume)   │
│                           │
│         group_by:         │
│ supp_nation, cust_nation, │
│           l_year          │
│                           │
│       mode: Partial       │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       ProjectionExec      │
│    --------------------   │
│    cust_nation: n_name    │
│                           │
│          l_year:          │
│date_part(YEAR, l_shipdate)│
│                           │
│    supp_nation: n_name    │
│                           │
│          volume:          │
│ l_extendedprice * (Some(1)│
│    ,20,0 - l_discount)    │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│        HashJoinExec       │
│    --------------------   │
│          filter:          │
│ n_name = FRANCE AND n_name│
│    = GERMANY OR n_name =  │
│    GERMANY AND n_name =   ├──────────────┐
│           FRANCE          │              │
│                           │              │
│            on:            │              │
│(n_nationkey = c_nationkey)│              │
└─────────────┬─────────────┘              │
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│   LiquidCacheClientExec   ││       ProjectionExec      │
│    --------------------   ││    --------------------   │
│          server:          ││        c_nationkey:       │
│  http://localhost:50051,  ││        c_nationkey        │
│      object_stores=[]     ││                           │
│                           ││        l_discount:        │
│                           ││         l_discount        │
│                           ││                           │
│                           ││      l_extendedprice:     │
│                           ││      l_extendedprice      │
│                           ││                           │
│                           ││        l_shipdate:        │
│                           ││         l_shipdate        │
│                           ││                           │
│                           ││       n_name: n_name      │
└─────────────┬─────────────┘└─────────────┬─────────────┘
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       DataSourceExec      ││        HashJoinExec       │
│    --------------------   ││    --------------------   │
│          files: 1         ││            on:            │
│      format: parquet      ││(n_nationkey = s_nationkey)│
│                           ││                           ├──────────────┐
│         predicate:        ││                           │              │
│ n_name = GERMANY OR n_name││                           │              │
│          = FRANCE         ││                           │              │
└───────────────────────────┘└─────────────┬─────────────┘              │
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │   LiquidCacheClientExec   ││       ProjectionExec      │
                             │    --------------------   ││    --------------------   │
                             │          server:          ││        c_nationkey:       │
                             │  http://localhost:50051,  ││        c_nationkey        │
                             │      object_stores=[]     ││                           │
                             │                           ││        l_discount:        │
                             │                           ││         l_discount        │
                             │                           ││                           │
                             │                           ││      l_extendedprice:     │
                             │                           ││      l_extendedprice      │
                             │                           ││                           │
                             │                           ││        l_shipdate:        │
                             │                           ││         l_shipdate        │
                             │                           ││                           │
                             │                           ││        s_nationkey:       │
                             │                           ││        s_nationkey        │
                             └─────────────┬─────────────┘└─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │       DataSourceExec      ││        HashJoinExec       │
                             │    --------------------   ││    --------------------   │
                             │          files: 1         ││            on:            │
                             │      format: parquet      ││  (c_custkey = o_custkey)  │
                             │                           ││                           ├──────────────┐
                             │         predicate:        ││                           │              │
                             │ n_name = FRANCE OR n_name ││                           │              │
                             │         = GERMANY         ││                           │              │
                             └───────────────────────────┘└─────────────┬─────────────┘              │
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │   LiquidCacheClientExec   ││       ProjectionExec      │
                                                          │    --------------------   ││    --------------------   │
                                                          │          server:          ││        l_discount:        │
                                                          │  http://localhost:50051,  ││         l_discount        │
                                                          │      object_stores=[]     ││                           │
                                                          │                           ││      l_extendedprice:     │
                                                          │                           ││      l_extendedprice      │
                                                          │                           ││                           │
                                                          │                           ││        l_shipdate:        │
                                                          │                           ││         l_shipdate        │
                                                          │                           ││                           │
                                                          │                           ││    o_custkey: o_custkey   │
                                                          │                           ││                           │
                                                          │                           ││        s_nationkey:       │
                                                          │                           ││        s_nationkey        │
                                                          └─────────────┬─────────────┘└─────────────┬─────────────┘
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │       DataSourceExec      ││        HashJoinExec       │
                                                          │    --------------------   ││    --------------------   │
                                                          │          files: 1         ││            on:            │
                                                          │      format: parquet      ││ (o_orderkey = l_orderkey) ├──────────────┐
                                                          │                           ││                           │              │
                                                          │         predicate:        ││                           │              │
                                                          │  DynamicFilter [ empty ]  ││                           │              │
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                       │   LiquidCacheClientExec   ││        HashJoinExec       │
                                                                                       │    --------------------   ││    --------------------   │
                                                                                       │          server:          ││            on:            ├──────────────┐
                                                                                       │  http://localhost:50051,  ││  (s_suppkey = l_suppkey)  │              │
                                                                                       │      object_stores=[]     ││                           │              │
                                                                                       └─────────────┬─────────────┘└─────────────┬─────────────┘              │
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                       │       DataSourceExec      ││   LiquidCacheClientExec   ││   LiquidCacheClientExec   │
                                                                                       │    --------------------   ││    --------------------   ││    --------------------   │
                                                                                       │          files: 1         ││          server:          ││          server:          │
                                                                                       │      format: parquet      ││  http://localhost:50051,  ││  http://localhost:50051,  │
                                                                                       │                           ││      object_stores=[]     ││      object_stores=[]     │
                                                                                       │         predicate:        ││                           ││                           │
                                                                                       │  DynamicFilter [ empty ]  ││                           ││                           │
                                                                                       └───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘
                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                                                    │       DataSourceExec      ││      RepartitionExec      │
                                                                                                                    │    --------------------   ││    --------------------   │
                                                                                                                    │          files: 1         ││ partition_count(in->out): │
                                                                                                                    │      format: parquet      ││           1 -> 8          │
                                                                                                                    │                           ││                           │
                                                                                                                    │         predicate:        ││    partitioning_scheme:   │
                                                                                                                    │  DynamicFilter [ empty ]  ││     RoundRobinBatch(8)    │
                                                                                                                    └───────────────────────────┘└─────────────┬─────────────┘
                                                                                                                                                 ┌─────────────┴─────────────┐
                                                                                                                                                 │       DataSourceExec      │
                                                                                                                                                 │    --------------------   │
                                                                                                                                                 │          files: 1         │
                                                                                                                                                 │      format: parquet      │
                                                                                                                                                 │                           │
                                                                                                                                                 │         predicate:        │
                                                                                                                                                 │  l_shipdate >= 1995-01-01 │
                                                                                                                                                 │   AND l_shipdate <= 1996  │
                                                                                                                                                 │ -12-31 AND DynamicFilter  │
                                                                                                                                                 │       [ empty ] AND       │
                                                                                                                                                 │        DynamicFilter      │
                                                                                                                                                 │          [ empty ]        │
                                                                                                                                                 └───────────────────────────┘
